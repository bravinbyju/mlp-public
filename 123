import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPRegressor
from sklearn.preprocessing import StandardScaler

# Load data
data = pd.read_csv("dataset.csv")

# Features: All pixel columns (pixel_1 to pixel_136)
X = data[[f"pixel_{i}" for i in range(1, 137)]]

# Target: Choose either 'bg_width' or 'middle_bg'
y = data["bg_width"]  # or data["middle_bg"]

# Split data
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Scale features (critical for neural networks)
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# Train MLP
model = MLPRegressor(hidden_layer_sizes=(128, 64), activation='relu', max_iter=500)
model.fit(X_train_scaled, y_train)

# Evaluate
predictions = model.predict(X_test_scaled)
